{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/bid%20master/app/api/collect-user-info/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport { google } from \"googleapis\";\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    console.log(\"ğŸ“ ì‚¬ìš©ì ì •ë³´ ìˆ˜ì§‘ API í˜¸ì¶œ\"); // ë¡œê·¸ ì¶”ê°€\r\n\r\n    const body = await request.json();\r\n    const { name, email, propertyTitle } = body;\r\n\r\n    // í•„ìˆ˜ í•„ë“œ ê²€ì¦\r\n    if (!name || !email) {\r\n      console.error(\"âŒ í•„ìˆ˜ í•„ë“œ ëˆ„ë½:\", { name, email }); // ë¡œê·¸ ì¶”ê°€\r\n      return NextResponse.json(\r\n        { success: false, error: \"ì´ë¦„ê³¼ ì´ë©”ì¼ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // í™˜ê²½ ë³€ìˆ˜ ê²€ì¦\r\n    const privateKey = process.env.GOOGLE_SHEETS_PRIVATE_KEY;\r\n    const clientEmail = process.env.GOOGLE_SHEETS_CLIENT_EMAIL;\r\n    const sheetId = process.env.GOOGLE_SHEET_ID;\r\n\r\n    if (!privateKey || !clientEmail || !sheetId) {\r\n      console.error(\"âŒ êµ¬ê¸€ ì‹œíŠ¸ í™˜ê²½ ë³€ìˆ˜ ëˆ„ë½\"); // ë¡œê·¸ ì¶”ê°€\r\n      return NextResponse.json(\r\n        { success: false, error: \"ì„œë²„ ì„¤ì • ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\" },\r\n        { status: 500 }\r\n      );\r\n    }\r\n\r\n    // êµ¬ê¸€ ì‹œíŠ¸ API ì¸ì¦ ì„¤ì •\r\n    const auth = new google.auth.GoogleAuth({\r\n      credentials: {\r\n        private_key: privateKey.replace(/\\\\n/g, \"\\n\"),\r\n        client_email: clientEmail,\r\n      },\r\n      scopes: [\"https://www.googleapis.com/auth/spreadsheets\"],\r\n    });\r\n\r\n    const sheets = google.sheets({ version: \"v4\", auth });\r\n\r\n    // í˜„ì¬ ì‹œê°„\r\n    const timestamp = new Date().toLocaleString(\"ko-KR\", {\r\n      timeZone: \"Asia/Seoul\",\r\n      year: \"numeric\",\r\n      month: \"2-digit\",\r\n      day: \"2-digit\",\r\n      hour: \"2-digit\",\r\n      minute: \"2-digit\",\r\n      second: \"2-digit\",\r\n    });\r\n\r\n    // ì‹œíŠ¸ì— ë°ì´í„° ì¶”ê°€\r\n    const values = [[name, email, propertyTitle || \"ì•Œ ìˆ˜ ì—†ìŒ\", timestamp]];\r\n\r\n    console.log(\"ğŸ“Š êµ¬ê¸€ ì‹œíŠ¸ì— ë°ì´í„° ì¶”ê°€:\", {\r\n      name,\r\n      email,\r\n      propertyTitle,\r\n      timestamp,\r\n    }); // ë¡œê·¸ ì¶”ê°€\r\n\r\n    await sheets.spreadsheets.values.append({\r\n      spreadsheetId: sheetId,\r\n      range: \"A:D\", // Aì—´ë¶€í„° Dì—´ê¹Œì§€\r\n      valueInputOption: \"RAW\",\r\n      requestBody: {\r\n        values: values,\r\n      },\r\n    });\r\n\r\n    console.log(\"âœ… êµ¬ê¸€ ì‹œíŠ¸ ë°ì´í„° ì¶”ê°€ ì„±ê³µ\"); // ë¡œê·¸ ì¶”ê°€\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      message: \"ì •ìƒ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì •ì‹ì¶œì‹œê°€ ë˜ë©´ ì•Œë ¤ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.\",\r\n    });\r\n  } catch (error) {\r\n    console.error(\"âŒ êµ¬ê¸€ ì‹œíŠ¸ ì—°ë™ ì˜¤ë¥˜:\", error); // ë¡œê·¸ ì¶”ê°€\r\n\r\n    return NextResponse.json(\r\n      {\r\n        success: false,\r\n        error: \"ë°ì´í„° ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.\",\r\n      },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;;;;;;;AAGO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,QAAQ,GAAG,CAAC,wBAAwB,QAAQ;QAE5C,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,aAAa,EAAE,GAAG;QAEvC,WAAW;QACX,IAAI,CAAC,QAAQ,CAAC,OAAO;YACnB,QAAQ,KAAK,CAAC,eAAe;gBAAE;gBAAM;YAAM,IAAI,QAAQ;YACvD,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAkB,GAC3C;gBAAE,QAAQ;YAAI;QAElB;QAEA,WAAW;QACX,MAAM,aAAa,QAAQ,GAAG,CAAC,yBAAyB;QACxD,MAAM,cAAc,QAAQ,GAAG,CAAC,0BAA0B;QAC1D,MAAM,UAAU,QAAQ,GAAG,CAAC,eAAe;QAE3C,IAAI,CAAC,cAAc,CAAC,eAAe,CAAC,SAAS;YAC3C,QAAQ,KAAK,CAAC,qBAAqB,QAAQ;YAC3C,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAoB,GAC7C;gBAAE,QAAQ;YAAI;QAElB;QAEA,kBAAkB;QAClB,MAAM,OAAO,IAAI,OAAO,IAAI,CAAC,UAAU,CAAC;YACtC,aAAa;gBACX,aAAa,WAAW,OAAO,CAAC,QAAQ;gBACxC,cAAc;YAChB;YACA,QAAQ;gBAAC;aAA+C;QAC1D;QAEA,MAAM,SAAS,OAAO,MAAM,CAAC;YAAE,SAAS;YAAM;QAAK;QAEnD,QAAQ;QACR,MAAM,YAAY,IAAI,OAAO,cAAc,CAAC,SAAS;YACnD,UAAU;YACV,MAAM;YACN,OAAO;YACP,KAAK;YACL,MAAM;YACN,QAAQ;YACR,QAAQ;QACV;QAEA,aAAa;QACb,MAAM,SAAS;YAAC;gBAAC;gBAAM;gBAAO,iBAAiB;gBAAU;aAAU;SAAC;QAEpE,QAAQ,GAAG,CAAC,qBAAqB;YAC/B;YACA;YACA;YACA;QACF,IAAI,QAAQ;QAEZ,MAAM,OAAO,YAAY,CAAC,MAAM,CAAC,MAAM,CAAC;YACtC,eAAe;YACf,OAAO;YACP,kBAAkB;YAClB,aAAa;gBACX,QAAQ;YACV;QACF;QAEA,QAAQ,GAAG,CAAC,sBAAsB,QAAQ;QAE1C,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,SAAS;QACX;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kBAAkB,QAAQ,QAAQ;QAEhD,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,SAAS;YACT,OAAO;QACT,GACA;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}